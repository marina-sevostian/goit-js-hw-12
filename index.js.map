{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport default class NewApiService {\n  constructor() {\n    this.searchQuery = '';\n    this.page = 1;\n    this.per_page = 15;\n  }\n  async fetchImages() {\n    const axiosOptions = {\n      method: 'get',\n      url: 'https://pixabay.com/api/',\n      params: {\n        key: '46729875-7729b8e358007a47de817f6d1',\n        q: `${this.searchQuery}`,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: `${this.page}`,\n        per_page: `${this.per_page}`,\n      },\n    };\n    try {\n      const response = await axios(axiosOptions);\n      const data = response.data;\n      this.incrementPage();\n      return data;\n    } catch (error) {\n      loader.classList.replace('loader', 'hide');\n      loadMoreBtn.classList.replace('load-more', 'hide');\n      iziToast.error({\n        title: 'Error',\n        message: `Error! Sorry, something went wrong. This is an error!`,\n        color: '#ef4040',\n        close: false,\n      });\n    }\n  }\n\n  incrementPage() {\n    this.page += 1;\n  }\n\n  resetPage() {\n    this.page = 1;\n  }\n  resetEndOfHits() {\n    this.endOfHits = false;\n  }\n  get query() {\n    return this.searchQuery;\n  }\n  set query(newQuery) {\n    this.searchQuery = newQuery;\n  }\n}\n","let gallery = document.querySelector('.gallery');\n\nexport function renderImages(hits) {\n  const markup = hits\n    .map(item => {\n      return `<div class=\"photo\">\n   <a class=\"gallery-link\" href=\"${item.largeImageURL}\">\n    <img\n      class=\"gallery-image\"\n      src=\"${item.webformatURL}\"\n      data-source=\"${item.largeImageURL}\"\n      alt=\"${item.tags}\"\n    />\n  </a>\n  <div class=\"info\">\n  <p class=\"info-item\">Likes <span class=\"info-item-num\">${item.likes}</span></p>\n  <p class=\"info-item\">Views <span class=\"info-item-num\">${item.views}</span></p>\n  <p class=\"info-item\">Comments <span class=\"info-item-num\">${item.comments}</span></p>\n  <p class=\"info-item\">Downloads <span class=\"info-item-num\">${item.downloads}</span></p>\n  </div>\n     </div> `;\n    })\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n}\n","import axios from 'axios';\n\nimport NewApiService from './js/pixabay-api';\nimport { renderImages } from './js/render-functions';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nlet gallery = document.querySelector('.gallery');\nconst fetchImagesBtn = document.querySelector('.search-form-btn');\nlet searchFormEl = document.querySelector('.search-form');\nlet inputForm = document.querySelector('.search-form-input');\nlet gallerySimpleLightbox = new SimpleLightbox('.gallery a');\nlet loader = document.querySelector('.loader');\nlet loadMoreBtn = document.querySelector('.load-more');\n\nloader.classList.replace('loader', 'hide');\nloadMoreBtn.classList.replace('load-more', 'hide');\n\nlet isShown = 0;\nconst newsApiService = new NewApiService();\n\nsearchFormEl.addEventListener('submit', onSearch);\nloadMoreBtn.addEventListener('click', onLoadMore);\n\nfunction onSearch(element) {\n  element.preventDefault();\n  cleanHtml();\n  newsApiService.query =\n    element.currentTarget.elements.searchQuery.value.trim();\n  loader.classList.replace('hide', 'loader');\n  loadMoreBtn.classList.replace('load-more', 'hide');\n  newsApiService.resetPage();\n  if (newsApiService.query !== '') {\n    isShown = 0;\n    fetchImages();\n    // renderImages(hits);\n    searchFormEl.reset();\n    return;\n  } else {\n    loader.classList.replace('loader', 'hide');\n    iziToast.warning({\n      title: 'Caution',\n      message: `You forgot important data! Enter something!`,\n      color: '#ffa000',\n      close: false,\n    });\n    return;\n  }\n}\n\nasync function fetchImages() {\n  loadMoreBtn.classList.replace('load-more', 'hide');\n\n  const result = await newsApiService.fetchImages();\n  const { hits, totalHits } = result;\n  isShown += hits.length;\n\n  if (!hits.length) {\n    iziToast.error({\n      title: 'Error',\n      message: `Sorry, there are no images matching your search query. Please try again!`,\n      color: '#ef4040',\n      close: false,\n    });\n    loader.classList.replace('loader', 'hide');\n    loadMoreBtn.classList.replace('load-more', 'hide');\n    return;\n  }\n  renderImages(hits);\n  let oneImage = document.querySelector('.gallery-image');\n  let rect = oneImage.getBoundingClientRect();\n  window.scrollBy(0, -window.innerHeight);\n  window.scrollBy({\n    top: rect.height * 2,\n    behavior: 'smooth',\n  });\n  isShown += hits.length;\n  gallerySimpleLightbox.refresh();\n  loader.classList.replace('loader', 'hide');\n  if (isShown < totalHits) {\n    loadMoreBtn.classList.replace('hide', 'load-more');\n  }\n  if (isShown >= totalHits) {\n    loadMoreBtn.classList.replace('load-more', 'hide');\n    iziToast.error({\n      title: 'Error',\n      message: `We're sorry, but you've reached the end of search results.`,\n      color: '#ef4040',\n      close: false,\n    });\n  }\n}\n\nnew SimpleLightbox('.gallery a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\nfunction cleanHtml() {\n  gallery.innerHTML = '';\n}\n\nfunction onLoadMore() {\n  // newsApiService.incrementPage();\n  loader.classList.replace('hide', 'loader');\n  loader.classList.add('loader-under-btn');\n  loadMoreBtn.classList.replace('load-more', 'hide');\n  fetchImages();\n  loader.classList.remove('loader-under-btn');\n}\n\n// let loaderUnderBtn = loader.getBoundingClientRect();\n// loader.scroll(0, -window.innerHeight);\n// loader.scroll({\n//   top: window.innerHeight - loaderUnderBtn.bottom,\n//   behavior: 'instant',\n// });\n"],"names":["NewApiService","axiosOptions","data","axios","iziToast","newQuery","gallery","renderImages","hits","markup","item","searchFormEl","gallerySimpleLightbox","SimpleLightbox","loader","loadMoreBtn","isShown","newsApiService","onSearch","onLoadMore","element","cleanHtml","fetchImages","result","totalHits","rect"],"mappings":"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"}